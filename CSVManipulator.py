import csv

class CSVManipulator:
    def __init__(self, csv_file):
        self.csvFile = csv_file
        order = ["name", "details", "published date", "updated date", "cvss score",
                  "vulnerability types", "cwd ID", "products affected"]
        writeLine(self.csvFile, order)

    def writeCVEVulnerability(self,
                              csv_file=None,
                              name=None,
                              details=None,
                              publish_date=None,
                              update_date=None,
                              cvss_score=None,
                              vuln_types=None,
                              cwd_ID=None,
                              products=None):
        if(not csv_file):
            csv_file = self.csvFile
        writeLine(csv_file, [name, details, publish_date, update_date, cvss_score,
                             vuln_types, cwd_ID, products])

def writeLine(csv_file, contents):
    with open(csv_file, "a", newline='') as csvfile:
        vulnWriter = csv.writer(csvfile, delimiter='|')
        vulnWriter.writerow(contents)
