import torch
from torch.utils import data
from FextractorPreprocessor import FextractorPreprocessor
import numpy as np

class VDataset(data.Dataset):
    def __init__(self, data):
        self.data = data
        #self.extra = extra


    def __len__(self):
        return len(self.data.keys())


    def __getitem__(self, index):
        feature1 = torch.from_numpy(self.data[index].X[0].astype(np.float32))
        label = self.data[index].y
        feature2 = torch.from_numpy(self.data[index].X[1].astype(np.float32)) if(len(self.data[index].X) > 1) else torch.empty(0)
        return feature1, feature2, label
