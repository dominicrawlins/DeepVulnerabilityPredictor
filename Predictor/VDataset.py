import torch
from torch.utils import data
from FextractorPreprocessor import FextractorPreprocessor
import numpy as np

class VDataset(data.Dataset):
    def __init__(self, data):
        self.data = data
        #self.extra = extra


    def __len__(self):
        return len(self.data.keys())


    def __getitem__(self, index):
        vstatic = torch.from_numpy(self.data[index].X['vstatic'].astype(np.float32)) if('vstatic' in self.data[index].X) else torch.empty(0)
        label = self.data[index].label
        vdynamic = torch.from_numpy(self.data[index].X['vdynamic'].astype(np.float32)) if('vdynamic' in self.data[index].X) else torch.empty(0)
        return vstatic, vdynamic, label
